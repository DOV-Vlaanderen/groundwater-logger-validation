<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="date" content="2019-07-10" />

<title>User documentation</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">User documentation</h1>
<h4 class="date">2019-07-10</h4>


<div id="TOC">
<ul>
<li><a href="#outliers">Outliers</a><ul>
<li><a href="#detect_outliersx"><code>detect_outliers(x)</code></a><ul>
<li><a href="#estimation-of-cutoff-lines">Estimation of cutoff lines</a><ul>
<li><a href="#example">Example</a></li>
<li><a href="#simulation">Simulation</a></li>
</ul></li>
<li><a href="#estimation-of-mu-and-sigma">Estimation of <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span></a></li>
</ul></li>
<li><a href="#detect_outliersx-aprioriair-pressure-units-cmh2o"><code>detect_outliers(x, apriori(&quot;air pressure&quot;, units = &quot;cmH2O&quot;))</code></a></li>
<li><a href="#detect_outliersx-apriorihydrostatic-pressure-units-cmh2o"><code>detect_outliers(x, apriori(&quot;hydrostatic pressure&quot;, units = &quot;cmH2O&quot;))</code></a></li>
</ul></li>
<li><a href="#levelshifts">Levelshifts</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(gwloggeR)</code></pre></div>
<div id="outliers" class="section level1">
<h1>Outliers</h1>
<p>Outliers are single measurements that are considered very unlikely to occur.</p>
<div id="detect_outliersx" class="section level2">
<h2><code>detect_outliers(x)</code></h2>
<p>This function take in a vector of datapoints and returns a boolean vector of outlier indicators:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1000</span><span class="op">:</span><span class="dv">1005</span>, <span class="dv">975</span>)
x
<span class="co">#&gt; [1] 1000 1001 1002 1003 1004 1005  975</span>
<span class="kw">detect_outliers</span>(x)
<span class="co">#&gt; [1] FALSE FALSE FALSE FALSE FALSE FALSE  TRUE</span></code></pre></div>
<p>So why is <span class="math inline">\(975\)</span> considered an outlier? We can understand the decision procedure better if we add some comprehensive plots and extra output:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">detect_outliers</span>(x, <span class="dt">plot =</span> <span class="ot">TRUE</span>, <span class="dt">verbose =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>#&gt; [1] FALSE FALSE FALSE FALSE FALSE FALSE  TRUE
#&gt; attr(,&quot;class&quot;)
#&gt; [1] &quot;logical&quot;  &quot;Outliers&quot;
#&gt; attr(,&quot;x.mean&quot;)
#&gt; [1] 1002
#&gt; attr(,&quot;x.sd&quot;)
#&gt; [1] 2.9652
#&gt; attr(,&quot;sigma.reject&quot;)
#&gt; [1] 3.971425
#&gt; attr(,&quot;alpha&quot;)
#&gt; [1] 5e-04
#&gt; attr(,&quot;type&quot;)
#&gt; [1] &quot;two.sided&quot;
#&gt; attr(,&quot;fun.density&quot;)
#&gt; function (x) 
#&gt; dnorm(x, x.mean, x.sd)
#&gt; &lt;bytecode: 0x0000000017fc1288&gt;
#&gt; &lt;environment: 0x0000000015a9f648&gt;
#&gt; attr(,&quot;cutpoints&quot;)
#&gt; [1]  990.2239 1013.7761</code></pre>
<p>The underlying assumption for outlier detection is normality of <span class="math inline">\(x_i\)</span>. Top left plot shows the histogram of the data points. The green curve is the best-fit normal distribution, based on robust estimates of <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>. The cutoff points are signified by red vertical lines. The top right is the QQ-plot with cutoff points as horizontal lines. The bottom plot is the sequential data, with outliers in red.</p>
<div id="estimation-of-cutoff-lines" class="section level3">
<h3>Estimation of cutoff lines</h3>
<p>How do we determine where to place the red cutoff lines? Well, for start, we want to minimize false positives. Suppose that we take <span class="math inline">\(100\)</span> random points from a standard normal distribution. If we place the cutoff lines at <span class="math inline">\(c = \pm 1.96\)</span> then we expect to find <span class="math inline">\(5\)</span> outliers on average. But these are not real outliers! Remeber our assumption that all the points in this set are from the standard normal distribution. So we want to set the cutoff lines at the optimal place: not too small, so we don’t flag points as outliers incorrectly, but also not too big either, because in that case we might miss real outliers.</p>
<p>Let us formalize the above intuition. Assume that <span class="math inline">\(\mathbf{x}\)</span> consists of <span class="math inline">\(n\)</span> independent and identically distributed datapoints <span class="math inline">\((x_1, x_2, \dots, x_n)\)</span> taken from a standard normal distribution with fixed <span class="math inline">\(\mu = 0\)</span> and <span class="math inline">\(\sigma = 1\)</span>. Now we choose some <span class="math inline">\(c\)</span> as the cutoff line. We can then calculate the probability of at least one outlier detected in the <code>detect_outliers(x)</code> process:</p>
<p><span class="math display">\[
P(|x_1| &gt; c \lor |x_2| &gt; c \lor \; \dots \; \lor |x_n| &gt; c) = \alpha
\]</span></p>
<p>That probability is <span class="math inline">\(\alpha\)</span>. We want to set <span class="math inline">\(c\)</span> such that <span class="math inline">\(\alpha\)</span> is low. How low? Well, if we set it to <span class="math inline">\(1/2000\)</span> then it means that we will detect one or more outliers in <span class="math inline">\(1\)</span> out of <span class="math inline">\(2000\)</span> times we run <code>detect_outliers(x)</code>. Obviously, on average, this <span class="math inline">\(1\)</span> time we will be wrong, but in <span class="math inline">\(1999\)</span> of the other cases we will not. This seems a good value for a production setting.</p>
<p>Ok, so now that we know our optimal <span class="math inline">\(\alpha\)</span>, how do we compute <span class="math inline">\(c\)</span>? We first massage a bit the above equation:</p>
<p><span class="math display">\[
P(|x_1| &gt; c \lor |x_2| &gt; c \lor \; \dots \; \lor |x_n| &gt; c) = \alpha \\
1 - P(|x_1| \le c \land |x_2| \le c \land \; \dots \; \land |x_n| \le c) = \alpha \\
1 - \prod_i \Phi(|x_i| \le c) = \alpha \\
1 - \left[ 1 - 2\Phi(x &lt; -c) \right]^n = \alpha
\]</span></p>
<p>Now solving for <span class="math inline">\(c\)</span> is easy:</p>
<p><span class="math display">\[
c = -\Phi^{-1} \left( \frac{1-(1-\alpha)^\frac{1}{n}}{2} \right)
\]</span></p>
<p>where <span class="math inline">\(\Phi^{-1}(\cdot)\)</span> is the standard normal quantile function.</p>
<div id="example" class="section level4">
<h4>Example</h4>
<p>This is how <span class="math inline">\(c\)</span> behaves in function of <span class="math inline">\(n\)</span> with fixed <span class="math inline">\(\alpha = 1/2000\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(<span class="dt">n =</span> <span class="dv">5</span><span class="op">:</span><span class="dv">10000</span>), <span class="dt">mapping =</span> ggplot2<span class="op">::</span><span class="kw">aes</span>(<span class="dt">x =</span> n)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">stat_function</span>(<span class="dt">fun =</span> <span class="cf">function</span>(n) <span class="op">-</span><span class="kw">qnorm</span>((<span class="dv">1</span><span class="op">-</span>(<span class="dv">1</span><span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">2000</span>)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>n))<span class="op">/</span><span class="dv">2</span>), <span class="dt">col =</span> <span class="st">'black'</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">theme_light</span>() <span class="op">+</span><span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ylab</span>(<span class="st">'c'</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Note that this function is implemented in <code>gwloggeR:::c.optimal(alpha, n)</code>. So as long as we set <span class="math inline">\(c\)</span> to the optimal value we make sure that we will make a wrong <code>detect_outliers(x)</code> run (i.e. detect falsely one or more ouliers) in <span class="math inline">\(1/2000\)</span> of time.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># e.g. optimal c for 5000 points:</span>
gwloggeR<span class="op">:::</span><span class="kw">c.optimal</span>(<span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2000</span>, <span class="dt">n =</span> <span class="dv">5000</span>, <span class="dt">type =</span> <span class="st">&quot;two.sided&quot;</span>)
<span class="co">#&gt; [1] 5.326678</span></code></pre></div>
</div>
<div id="simulation" class="section level4">
<h4>Simulation</h4>
<p>TODO….</p>
</div>
</div>
<div id="estimation-of-mu-and-sigma" class="section level3">
<h3>Estimation of <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span></h3>
<p>In calculating <span class="math inline">\(c\)</span> we assumed <span class="math inline">\(x_i\)</span> being normal with <span class="math inline">\(\mu = 0\)</span> and <span class="math inline">\(\sigma = 1\)</span>. To make the above also work for <span class="math inline">\(y_i\)</span> from any normal distribution, we need to estimate <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>. Once we have the estimates, then we can standardize <span class="math inline">\(y_i\)</span> using <span class="math inline">\((y_i - \mu)/\sigma = x_i\)</span> and use the previous results on <span class="math inline">\(x_i\)</span>.</p>
<p>Mean and square root of variance give the most efficient estimators for <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> as long as <span class="math inline">\(\forall i : y_i \sim \mathcal{N}(\mu, \sigma^2)\)</span> and mutually independent. Under influence of real outliers, these estimators get easily biased. <span class="citation">(cf. Leys et al. 2013)</span> So we need more robust estimators for <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>.</p>
<p>In case of outliers, a way to measure robustness is the breakdown point. The maximum attainable breakdown point is <span class="math inline">\(50 \%\)</span>, meaning that <span class="math inline">\(50 \%\)</span> of observations can be replaced by arbitrary large numbers, without breaking the estimator. For <span class="math inline">\(\mu\)</span>, the obvious choice is the median. For <span class="math inline">\(\sigma\)</span> it is the median absolute deviation (MAD). They both have a <span class="math inline">\(50 \%\)</span> breakdown point. A problem with the latter is its efficiency (cf. simuation). There exist more efficient <span class="math inline">\(\sigma\)</span>-estimators than the MAD. For example the Q-estimator <span class="citation">(cf. Rousseeuw and Croux 1993)</span>. Currently, MAD suffices because we usualy have lots of data (<span class="math inline">\(n &gt; 5000\)</span>) so efficiency suffers less.</p>
</div>
</div>
<div id="detect_outliersx-aprioriair-pressure-units-cmh2o" class="section level2">
<h2><code>detect_outliers(x, apriori(&quot;air pressure&quot;, units = &quot;cmH2O&quot;))</code></h2>
<p>We can improve the outlier detection by providing <em>a-priori</em> information about <span class="math inline">\(\mathbf{x}\)</span>. For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">990</span><span class="op">:</span><span class="dv">999</span>)
<span class="kw">detect_outliers</span>(x, <span class="dt">apriori =</span> <span class="kw">apriori</span>(<span class="st">&quot;air pressure&quot;</span>, <span class="st">&quot;cmH2O&quot;</span>), <span class="dt">plot =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>#&gt;  [1]  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE</code></pre>
<p>Top left is again the histogram of <span class="math inline">\(\mathbf{x}\)</span>. But the green density this time is not a robust normal estimate based on <span class="math inline">\(\mathbf{x}\)</span>. Instead it is the hardcoded <em>a-priori</em> density distribution of air pressure (<span class="math inline">\(cmH_2O\)</span>) in Belgium. Given the <span class="math inline">\(10\)</span> points and assuming that we want to detect falsely one or more outliers in <span class="math inline">\(1\)</span> of <span class="math inline">\(2000\)</span> tests, we set the red cutoffs appropriately. This results in first <span class="math inline">\(4\)</span> points being identified as outliers.</p>
</div>
<div id="detect_outliersx-apriorihydrostatic-pressure-units-cmh2o" class="section level2">
<h2><code>detect_outliers(x, apriori(&quot;hydrostatic pressure&quot;, units = &quot;cmH2O&quot;))</code></h2>
<p>Hydrostatic pressure incorporates <em>a-priori</em> information about air pressure as the lower limit. The upper limit is determined with the <code>detect_outliers(x)</code> approach (i.e. without <em>a-priori</em> information). The following example explains:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">985</span>, <span class="dv">1070</span><span class="op">:</span><span class="dv">1077</span>, <span class="dv">1100</span>)
<span class="kw">detect_outliers</span>(x, <span class="dt">apriori =</span> <span class="kw">apriori</span>(<span class="st">&quot;hydrostatic pressure&quot;</span>, <span class="st">&quot;cmH2O&quot;</span>), <span class="dt">plot =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>#&gt;  [1]  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE</code></pre>
<p>The top left density is now bimodal. The first mode is just the <em>a-priori</em> air pressure, and the second is the robust estimate of the datapoints themselves, excluding the left outliers, using <code>detect_outliers(x)</code>. The reasoning is that hydrostatic pressure should never be higher than air pressure. Thus, since <span class="math inline">\(985 \; cmH_2O\)</span> is very unlikely given our <em>a-priori</em> air pressure information, it is considered an outlier. Subsequently, robust estimates of <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> are made based on remaining <span class="math inline">\(\mathbf{x}\)</span>, from which <span class="math inline">\(1100 \; cmH_2O\)</span> also seems very unlikely on the right side.</p>
</div>
</div>
<div id="levelshifts" class="section level1">
<h1>Levelshifts</h1>
<p>To be continued…</p>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references">
<div id="ref-Leys2013">
<p>Leys, Christophe, Christophe Ley, Olivier Klein, Philippe Bernard, and Laurent Licata. 2013. “Detecting Outliers: Do Not Use Standard Deviation Around the Mean, Use Absolute Deviation Around the Median.” <em>Journal of Experimental Social Psychology</em> 49 (4): 764–66. doi:<a href="https://doi.org/10.1016/j.jesp.2013.03.013">10.1016/j.jesp.2013.03.013</a>.</p>
</div>
<div id="ref-Rousseeuw1993">
<p>Rousseeuw, Peter J., and Christophe Croux. 1993. “Alternatives to the Median Absolute Deviation.” <em>Journal of the American Statistical Association</em> 88 (424). Taylor &amp; Francis: 1273–83. doi:<a href="https://doi.org/10.1080/01621459.1993.10476408">10.1080/01621459.1993.10476408</a>.</p>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
